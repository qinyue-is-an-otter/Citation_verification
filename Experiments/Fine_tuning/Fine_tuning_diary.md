### Let's call this a diary for now
I decide to write a file about my fine-tuning experiences with bert, because it's so tricky hahahahaha, I'm crazy, don't mind me 

##### 2025/08/05

**Traditional Fine-tuning**
The traditional fine-tuning result on augmented dataset is rediculous, I think our dataset is too simple, bert overfits extremely fast with 4 epochs + a low learning rate 1e-5 and 0.5 drop out
```bash
Test set before fine-tuning: test + ref

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.85it/s]
Test Accuracy:  0.470
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:11<00:00,  3.06it/s]
Test Accuracy:  0.342
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [01:35<00:00,  1.04it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.98it/s]
Epochs: 1 
              | Train Loss:  0.028 
              | Train Accuracy:  0.937 
              | Val Loss:  0.022 
              | Val Accuracy:  0.985
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [01:37<00:00,  1.02it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.96it/s]
Epochs: 2 
              | Train Loss:  0.020 
              | Train Accuracy:  0.993 
              | Val Loss:  0.021 
              | Val Accuracy:  0.985
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [01:38<00:00,  1.02it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.96it/s]
Epochs: 3 
              | Train Loss:  0.020 
              | Train Accuracy:  0.995 
              | Val Loss:  0.021 
              | Val Accuracy:  0.995
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [01:38<00:00,  1.02it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.96it/s]
Epochs: 4 
              | Train Loss:  0.020 
              | Train Accuracy:  0.998 
              | Val Loss:  0.021 
              | Val Accuracy:  0.995
Test set after fine-tuning:

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.99it/s]
Test Accuracy:  0.995
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:11<00:00,  2.94it/s]
Test Accuracy:  0.336
```
Not to my surprise, the accuracy on reference set is low as 0.336 after getting fine-tuned on augmented dataset, so I decide to freeze the whole bert model, only fine-tune the classifier after it as François suggested during winter school


**Fine-tuning with BERT freezed**

The training epochs is still 4, and learning rate is 1e-4 as bert parameters are all frozen. I tried with 1000 related + 1000 unrelated, then, the same parameters with 1000 related + 1000 unrelated. Luckily this works, thanks, françois
```bash
Test set before fine-tuning: test + ref

100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.89it/s]
Test Accuracy:  0.590
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:11<00:00,  3.04it/s]
Test Accuracy:  0.690
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:34<00:00,  2.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.00it/s]
Epochs: 1 
              | Train Loss:  0.041 
              | Train Accuracy:  0.663 
              | Val Loss:  0.042 
              | Val Accuracy:  0.715
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:35<00:00,  2.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.97it/s]
Epochs: 2 
              | Train Loss:  0.039 
              | Train Accuracy:  0.751 
              | Val Loss:  0.041 
              | Val Accuracy:  0.750
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:35<00:00,  2.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.95it/s]
Epochs: 3 
              | Train Loss:  0.037 
              | Train Accuracy:  0.782 
              | Val Loss:  0.039 
              | Val Accuracy:  0.780
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:35<00:00,  2.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.95it/s]
Epochs: 4 
              | Train Loss:  0.036 
              | Train Accuracy:  0.792 
              | Val Loss:  0.038 
              | Val Accuracy:  0.745
Test set after fine-tuning:

100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.99it/s]
Test Accuracy:  0.770
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:11<00:00,  2.94it/s]
Test Accuracy:  0.761
```

2000 + 2000
```bash
Test set before fine-tuning: test + ref

100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.88it/s]
Test Accuracy:  0.585
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:11<00:00,  3.05it/s]
Test Accuracy:  0.222
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [01:09<00:00,  2.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.86it/s]
Epochs: 1 
              | Train Loss:  0.040 
              | Train Accuracy:  0.749 
              | Val Loss:  0.038 
              | Val Accuracy:  0.823
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [01:10<00:00,  2.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.84it/s]
Epochs: 2 
              | Train Loss:  0.037 
              | Train Accuracy:  0.796 
              | Val Loss:  0.036 
              | Val Accuracy:  0.838
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [01:10<00:00,  2.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.83it/s]
Epochs: 3 
              | Train Loss:  0.035 
              | Train Accuracy:  0.807 
              | Val Loss:  0.034 
              | Val Accuracy:  0.840
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [01:11<00:00,  2.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.82it/s]
Epochs: 4 
              | Train Loss:  0.034 
              | Train Accuracy:  0.816 
              | Val Loss:  0.033 
              | Val Accuracy:  0.853
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [01:11<00:00,  2.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.82it/s]
Epochs: 5 
              | Train Loss:  0.033 
              | Train Accuracy:  0.820 
              | Val Loss:  0.032 
              | Val Accuracy:  0.865
Test set after fine-tuning:

100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.87it/s]
Test Accuracy:  0.840
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:11<00:00,  2.94it/s]
Test Accuracy:  0.765
```
4 Epoches 2000 + 2000
```bash
Test set before fine-tuning: test + ref

100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.90it/s]
Test Accuracy:  0.507
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:11<00:00,  3.06it/s]
Test Accuracy:  0.194
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [01:08<00:00,  2.92it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.88it/s]
Epochs: 1 
              | Train Loss:  0.041 
              | Train Accuracy:  0.676 
              | Val Loss:  0.039 
              | Val Accuracy:  0.787
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [01:10<00:00,  2.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.85it/s]
Epochs: 2 
              | Train Loss:  0.038 
              | Train Accuracy:  0.784 
              | Val Loss:  0.036 
              | Val Accuracy:  0.812
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [01:11<00:00,  2.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.81it/s]
Epochs: 3 
              | Train Loss:  0.036 
              | Train Accuracy:  0.801 
              | Val Loss:  0.035 
              | Val Accuracy:  0.812
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [01:11<00:00,  2.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.80it/s]
Epochs: 4 
              | Train Loss:  0.034 
              | Train Accuracy:  0.812 
              | Val Loss:  0.034 
              | Val Accuracy:  0.823
Test set after fine-tuning:

100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.87it/s]
Test Accuracy:  0.823
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:11<00:00,  2.94it/s]
Test Accuracy:  0.791
```
lr: 1e-4, 2000 + 2000
```bash
Test set before fine-tuning: test + ref

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.89it/s]
Test Accuracy:  0.520
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:11<00:00,  3.06it/s]
Test Accuracy:  0.216
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [01:08<00:00,  2.92it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.88it/s]
Epochs: 1 
              | Train Loss:  0.040 
              | Train Accuracy:  0.728 
              | Val Loss:  0.038 
              | Val Accuracy:  0.770
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [01:10<00:00,  2.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.84it/s]
Epochs: 2 
              | Train Loss:  0.037 
              | Train Accuracy:  0.793 
              | Val Loss:  0.036 
              | Val Accuracy:  0.810
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [01:11<00:00,  2.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.81it/s]
Epochs: 3 
              | Train Loss:  0.035 
              | Train Accuracy:  0.803 
              | Val Loss:  0.034 
              | Val Accuracy:  0.818
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [01:11<00:00,  2.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.80it/s]
Epochs: 4 
              | Train Loss:  0.034 
              | Train Accuracy:  0.810 
              | Val Loss:  0.033 
              | Val Accuracy:  0.825
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [01:11<00:00,  2.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.81it/s]
Epochs: 5 
              | Train Loss:  0.033 
              | Train Accuracy:  0.823 
              | Val Loss:  0.033 
              | Val Accuracy:  0.843
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [01:11<00:00,  2.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.80it/s]
Epochs: 6 
              | Train Loss:  0.033 
              | Train Accuracy:  0.828 
              | Val Loss:  0.032 
              | Val Accuracy:  0.845
Test set after fine-tuning:

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.86it/s]
Test Accuracy:  0.828
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:11<00:00,  2.94it/s]
Test Accuracy:  0.727
```

learning rate: 1e-4, epochs: 7 1000 + 1000
```bash
Test set before fine-tuning: test + ref

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.92it/s]
Test Accuracy:  0.455
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:11<00:00,  3.06it/s]
Test Accuracy:  0.224
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:33<00:00,  2.95it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.06it/s]
Epochs: 1 
              | Train Loss:  0.043 
              | Train Accuracy:  0.586 
              | Val Loss:  0.043 
              | Val Accuracy:  0.615
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:34<00:00,  2.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.00it/s]
Epochs: 2 
              | Train Loss:  0.040 
              | Train Accuracy:  0.765 
              | Val Loss:  0.041 
              | Val Accuracy:  0.715
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:35<00:00,  2.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.98it/s]
Epochs: 3 
              | Train Loss:  0.038 
              | Train Accuracy:  0.796 
              | Val Loss:  0.040 
              | Val Accuracy:  0.725
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:35<00:00,  2.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.96it/s]
Epochs: 4 
              | Train Loss:  0.037 
              | Train Accuracy:  0.810 
              | Val Loss:  0.039 
              | Val Accuracy:  0.770
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:35<00:00,  2.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.95it/s]
Epochs: 5 
              | Train Loss:  0.036 
              | Train Accuracy:  0.813 
              | Val Loss:  0.038 
              | Val Accuracy:  0.775
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:35<00:00,  2.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.95it/s]
Epochs: 6 
              | Train Loss:  0.035 
              | Train Accuracy:  0.821 
              | Val Loss:  0.037 
              | Val Accuracy:  0.755
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:35<00:00,  2.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.93it/s]
Epochs: 7 
              | Train Loss:  0.034 
              | Train Accuracy:  0.824 
              | Val Loss:  0.037 
              | Val Accuracy:  0.790
Test set after fine-tuning:

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  2.98it/s]
Test Accuracy:  0.815
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:11<00:00,  2.93it/s]
Test Accuracy:  0.806
```
learning rate: 2e-4, epochs: 5 5000 + 5000
```bash
Test set before fine-tuning: test + ref

100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.86it/s]
Test Accuracy:  0.505
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:11<00:00,  3.03it/s]
Test Accuracy:  0.226
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [01:09<00:00,  2.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.85it/s]
Epochs: 1 
              | Train Loss:  0.039 
              | Train Accuracy:  0.737 
              | Val Loss:  0.035 
              | Val Accuracy:  0.797
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [01:10<00:00,  2.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.84it/s]
Epochs: 2 
              | Train Loss:  0.035 
              | Train Accuracy:  0.801 
              | Val Loss:  0.033 
              | Val Accuracy:  0.853
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [01:11<00:00,  2.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.83it/s]
Epochs: 3 
              | Train Loss:  0.033 
              | Train Accuracy:  0.820 
              | Val Loss:  0.031 
              | Val Accuracy:  0.860
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [01:11<00:00,  2.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.83it/s]
Epochs: 4 
              | Train Loss:  0.032 
              | Train Accuracy:  0.829 
              | Val Loss:  0.030 
              | Val Accuracy:  0.873
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [01:11<00:00,  2.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.82it/s]
Epochs: 5 
              | Train Loss:  0.031 
              | Train Accuracy:  0.847 
              | Val Loss:  0.030 
              | Val Accuracy:  0.880
Test set after fine-tuning:

100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.87it/s]
Test Accuracy:  0.873
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:11<00:00,  2.94it/s]
Test Accuracy:  0.630
```

Apparently, with learning rate at 2e-4, the model starts to lose its generalizability

#### For sbert:

**Unfreezed sbert**
5e-5 1000 + 1000
```bash
Test set before fine-tuning: test + ref

100%|██████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.40it/s]
Test Accuracy:  0.400
100%|██████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:13<00:00,  2.48it/s]
Test Accuracy:  0.289
100%|████████████████████████████████████████████████████████████████████████████████████████| 100/100 [01:34<00:00,  1.06it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.44it/s]
Epochs: 1 
              | Train Loss:  0.024 
              | Train Accuracy:  0.956 
              | Val Loss:  0.021 
              | Val Accuracy:  0.990
100%|████████████████████████████████████████████████████████████████████████████████████████| 100/100 [01:34<00:00,  1.05it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.45it/s]
Epochs: 2 
              | Train Loss:  0.020 
              | Train Accuracy:  0.993 
              | Val Loss:  0.021 
              | Val Accuracy:  0.995
100%|████████████████████████████████████████████████████████████████████████████████████████| 100/100 [01:35<00:00,  1.05it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.44it/s]
Epochs: 3 
              | Train Loss:  0.020 
              | Train Accuracy:  0.996 
              | Val Loss:  0.021 
              | Val Accuracy:  0.995
100%|████████████████████████████████████████████████████████████████████████████████████████| 100/100 [01:34<00:00,  1.05it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.44it/s]
Epochs: 4 
              | Train Loss:  0.020 
              | Train Accuracy:  0.999 
              | Val Loss:  0.021 
              | Val Accuracy:  0.995
Test set after fine-tuning:

100%|██████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.46it/s]
Test Accuracy:  1.000
100%|██████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:14<00:00,  2.42it/s]
Test Accuracy:  0.066
```

5e-5, 1000 + 1000
```bash
Test set before fine-tuning: test + ref

100% 13/13 [00:06<00:00,  1.88it/s]
Test Accuracy:  0.405
100% 34/34 [00:18<00:00,  1.89it/s]
Test Accuracy:  0.286
100% 100/100 [01:00<00:00,  1.64it/s]
100% 13/13 [00:07<00:00,  1.80it/s]
Epochs: 1 
              | Train Loss:  0.043 
              | Train Accuracy:  0.495 
              | Val Loss:  0.045 
              | Val Accuracy:  0.600
100% 100/100 [00:59<00:00,  1.69it/s]
100% 13/13 [00:07<00:00,  1.73it/s]
Epochs: 2 
              | Train Loss:  0.043 
              | Train Accuracy:  0.700 
              | Val Loss:  0.044 
              | Val Accuracy:  0.740
100% 100/100 [00:59<00:00,  1.69it/s]
100% 13/13 [00:07<00:00,  1.75it/s]
Epochs: 3 
              | Train Loss:  0.043 
              | Train Accuracy:  0.807 
              | Val Loss:  0.044 
              | Val Accuracy:  0.800
100% 100/100 [00:59<00:00,  1.68it/s]
100% 13/13 [00:07<00:00,  1.75it/s]
Epochs: 4 
              | Train Loss:  0.042 
              | Train Accuracy:  0.863 
              | Val Loss:  0.044 
              | Val Accuracy:  0.845
Test set after fine-tuning:

100% 13/13 [00:07<00:00,  1.77it/s]
Test Accuracy:  0.860
100% 34/34 [00:18<00:00,  1.79it/s]
Test Accuracy:  0.528
```

1e-4, 2 epoches 1000 + 1000
```bash
Test set before fine-tuning: test + ref

100% 13/13 [00:06<00:00,  1.99it/s]
Test Accuracy:  0.520
100% 34/34 [00:17<00:00,  2.00it/s]
Test Accuracy:  0.410
100% 100/100 [00:58<00:00,  1.71it/s]
100% 13/13 [00:07<00:00,  1.69it/s]
Epochs: 1 
              | Train Loss:  0.043 
              | Train Accuracy:  0.621 
              | Val Loss:  0.045 
              | Val Accuracy:  0.710
100% 100/100 [00:58<00:00,  1.70it/s]
100% 13/13 [00:07<00:00,  1.75it/s]
Epochs: 2 
              | Train Loss:  0.043 
              | Train Accuracy:  0.781 
              | Val Loss:  0.044 
              | Val Accuracy:  0.825
100% 100/100 [00:59<00:00,  1.67it/s]
100% 13/13 [00:07<00:00,  1.77it/s]
Epochs: 3 
              | Train Loss:  0.042 
              | Train Accuracy:  0.847 
              | Val Loss:  0.044 
              | Val Accuracy:  0.890
Test set after fine-tuning:

100% 13/13 [00:07<00:00,  1.78it/s]
Test Accuracy:  0.860
100% 34/34 [00:19<00:00,  1.79it/s]
Test Accuracy:  0.635
```
1e-4 1000 + 1000
```bash
Test set before fine-tuning: test + ref

  0%|                                                                                                                                       | 0/13 [00:00<?, ?it/s]/home/getalp/liuqi/miniconda3/envs/cos_simi/lib/python3.10/site-packages/torch/nn/modules/module.py:1739: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  return self._call_impl(*args, **kwargs)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.42it/s]
Test Accuracy:  0.480
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:13<00:00,  2.51it/s]
Test Accuracy:  0.231
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:41<00:00,  2.42it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.52it/s]
Epochs: 1 
              | Train Loss:  0.043 
              | Train Accuracy:  0.644 
              | Val Loss:  0.044 
              | Val Accuracy:  0.825
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:42<00:00,  2.38it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.48it/s]
Epochs: 2 
              | Train Loss:  0.042 
              | Train Accuracy:  0.882 
              | Val Loss:  0.043 
              | Val Accuracy:  0.940
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:42<00:00,  2.36it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.47it/s]
Epochs: 3 
              | Train Loss:  0.041 
              | Train Accuracy:  0.937 
              | Val Loss:  0.043 
              | Val Accuracy:  0.945
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:42<00:00,  2.35it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.46it/s]
Epochs: 4 
              | Train Loss:  0.040 
              | Train Accuracy:  0.943 
              | Val Loss:  0.042 
              | Val Accuracy:  0.935
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:42<00:00,  2.35it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.45it/s]
Epochs: 5 
              | Train Loss:  0.040 
              | Train Accuracy:  0.944 
              | Val Loss:  0.041 
              | Val Accuracy:  0.935
Test set after fine-tuning:

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.46it/s]
Test Accuracy:  0.955
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:14<00:00,  2.42it/s]
Test Accuracy:  0.639
```

5e-5 1000 + 1000
```bash
Test set before fine-tuning: test + ref

100% 13/13 [00:06<00:00,  1.98it/s]
Test Accuracy:  0.480
100% 34/34 [00:16<00:00,  2.03it/s]
Test Accuracy:  0.273
100% 100/100 [00:57<00:00,  1.74it/s]
100% 13/13 [00:07<00:00,  1.67it/s]
Epochs: 1 
              | Train Loss:  0.043 
              | Train Accuracy:  0.611 
              | Val Loss:  0.045 
              | Val Accuracy:  0.730
100% 100/100 [00:59<00:00,  1.69it/s]
100% 13/13 [00:07<00:00,  1.77it/s]
Epochs: 2 
              | Train Loss:  0.043 
              | Train Accuracy:  0.799 
              | Val Loss:  0.044 
              | Val Accuracy:  0.855
100% 100/100 [00:59<00:00,  1.67it/s]
100% 13/13 [00:07<00:00,  1.75it/s]
Epochs: 3 
              | Train Loss:  0.042 
              | Train Accuracy:  0.869 
              | Val Loss:  0.044 
              | Val Accuracy:  0.885
100% 100/100 [00:59<00:00,  1.68it/s]
100% 13/13 [00:07<00:00,  1.75it/s]
Epochs: 4 
              | Train Loss:  0.042 
              | Train Accuracy:  0.886 
              | Val Loss:  0.043 
              | Val Accuracy:  0.905
Test set after fine-tuning:

100% 13/13 [00:07<00:00,  1.76it/s]
Test Accuracy:  0.870
100% 34/34 [00:19<00:00,  1.79it/s]
Test Accuracy:  0.620

# Now same parametors, but 2000 + 2000

Test set before fine-tuning: test + ref

100%|█████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:10<00:00,  2.45it/s]
Test Accuracy:  0.398
100%|█████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:13<00:00,  2.47it/s]
Test Accuracy:  0.165
100%|███████████████████████████████████████████████████████████████████████████████████████| 200/200 [01:23<00:00,  2.40it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:10<00:00,  2.38it/s]
Epochs: 1 
              | Train Loss:  0.043 
              | Train Accuracy:  0.608 
              | Val Loss:  0.043 
              | Val Accuracy:  0.818
100%|███████████████████████████████████████████████████████████████████████████████████████| 200/200 [01:24<00:00,  2.36it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:10<00:00,  2.36it/s]
Epochs: 2 
              | Train Loss:  0.042 
              | Train Accuracy:  0.845 
              | Val Loss:  0.042 
              | Val Accuracy:  0.890
100%|███████████████████████████████████████████████████████████████████████████████████████| 200/200 [01:25<00:00,  2.35it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:10<00:00,  2.35it/s]
Epochs: 3 
              | Train Loss:  0.042 
              | Train Accuracy:  0.899 
              | Val Loss:  0.041 
              | Val Accuracy:  0.925
100%|███████████████████████████████████████████████████████████████████████████████████████| 200/200 [01:25<00:00,  2.35it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:10<00:00,  2.35it/s]
Epochs: 4 
              | Train Loss:  0.041 
              | Train Accuracy:  0.914 
              | Val Loss:  0.040 
              | Val Accuracy:  0.938
Test set after fine-tuning:

100%|█████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:10<00:00,  2.37it/s]
Test Accuracy:  0.925
100%|█████████████████████████████████████████████████████████████████████████████████████████| 34/34 [00:14<00:00,  2.42it/s]
Test Accuracy:  0.534

```